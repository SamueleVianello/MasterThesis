shiny::runApp()
runApp()
runApp()
shiny::runApp()
DEoptim::DEoptim()
library(quantmod)
my.df <- getSymbols(Symbols = '500.L', auto.assign = FALSE)
SP_500_EUR = na.omit(my.df[,3])
my.df <- getSymbols(Symbols = '36BY.DE', auto.assign = FALSE)
Nikkei_EUR = na.omit(my.df[,3])
fdy <- function(dy, dt, lambda, mu, sigma, muq, sigmaq) {
mu1 <- (mu - sigma^2 / 2) * dt
mu2 <- (mu - sigma^2 / 2) * dt + muq
sig1 <- sigma * sqrt(dt)
sig2 <- sqrt(sigma^2 * dt + sigmaq^2)
pdf1 <- dnorm(dy, mean = mu1, sd = sig1)
pdf2 <- dnorm(dy, mean = mu2, sd = sig2)
pdf <- (1 - lambda * dt) * pdf1 + (lambda * dt) * pdf2
return(pdf)
}
negloglik <- function(theta, dy, dt) {
L <- fdy(dy = dy, dt = dt, lambda = theta[1],
mu = theta[2], sigma = theta[3],
muq = theta[4], sigmaq = theta[5])
nll <- -sum(log(L))
if (is.nan(nll) | is.na(nll) | is.infinite(nll)) {
nll <- 1e10
}
return(nll)
}
dy <- diff(log(as.vector(SP_500_EUR)))
dt <- 1 / 255
outDE <- DEoptim(negloglik,
lower = c( 0.1, -10, 1e-4, -10, 1e-4),
upper = c(100, 10, 10, 10, 10),
control = list(itermax = 500, NP = 100), dt = dt, dy = dy)
parametri=outDE$optim$bestmem
par=parametri[c(2,3,1,4,5)]
plot(SP_500_EUR, type='l')
# parametri processo Merton S&P 500 currency hedged in EUR
drift_1 = par[1]
sigma_1= par[2]
lambda_1=par[3]
mu_q_1=par[4]
sigma_q_1=par[5]
TotalTime=length(SP_500_EUR)*dt
hist(dy,breaks=200,prob=TRUE,main="S&P 500 currency hedged in EUR",xlab="daily returns")
curve(dnorm(x, mean=mean(dy), sd=sd(dy)), add=TRUE,col="blue")
lines(sort(dy),fdy (dy=sort(dy),dt=dt, lambda=lambda_1, mu=drift_1, sigma=sigma_1,muq= mu_q_1, sigmaq=sigma_q_1),col="red")
legend("topright", legend = c("Real", "Black-Scholes","Merton"),col=c('black','blue','red'),lwd=3, pch = c(NA, NA,NA),lty=c(1,1,1))
dy <- diff(log(as.vector(Nikkei_EUR)))
dt <- 1 / 255
outDE <- DEoptim(negloglik,
lower = c( 0.1, -10, 1e-4, -10, 1e-4),
upper = c(100, 10, 10, 10, 10),
control = list(itermax = 500, NP = 100), dt = dt, dy = dy)
parametri=outDE$optim$bestmem
par=parametri[c(2,3,1,4,5)]
plot(Nikkei_EUR, type='l')
TotalTime=length(Nikkei_EUR)*dt
drift_1 = par[1]
sigma_1= par[2]
lambda_1=par[3]
mu_q_1=par[4]
sigma_q_1=par[5]
hist(dy,breaks=200,prob=TRUE,main="Nikkei currency hedged in EUR",xlab="daily returns")
curve(dnorm(x, mean=mean(dy), sd=sd(dy)), add=TRUE,col="blue")
lines(sort(dy),fdy (dy=sort(dy),dt=dt, lambda=lambda_1, mu=drift_1, sigma=sigma_1,muq= mu_q_1, sigmaq=sigma_q_1),col="red")
legend("topright", legend = c("Real", "Black-Scholes","Merton"),col=c('black','blue','red'),lwd=3, pch = c(NA, NA,NA),lty=c(1,1,1))
?getSymbols
plot(SP_500_EUR,type = 'l')
whos(SP_500_EUR)
whos()
SP_500_EUR
?browser
setwd("C:/Users/marco/Desktop/Stage Samuele Vianello 2018/Stage Samuele - code")
setwd("C:/Users/marco/Desktop/Stage Elia Mazzoni 2018/Stage Elia Versione finale/Elia Project Robo Advisory")
setwd("C:/Users/marco/Desktop/Stage Samuele Vianello 2018/Stage Samuele - code")
